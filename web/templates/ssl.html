{{template "base.html" .}}
{{define "title"}}SSL Certificates{{end}}
{{define "content"}}
<div class="container">
    <h1>üîí SSL Certificates (Let's Encrypt)</h1>
    
    {{if .error}}
    <div class="alert alert-error">‚ùå {{.error}}</div>
    {{end}}
    
    {{if .success}}
    <div class="alert alert-success">‚úÖ ‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</div>
    {{end}}
    
    <!-- Issue New Certificate -->
    <div class="card">
        <h2>üìú ‡∏Ç‡∏≠ SSL Certificate ‡πÉ‡∏´‡∏°‡πà</h2>
        <form action="/ssl/issue" method="POST">
            <div class="form-group">
                <label>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Domain:</label>
                <select name="domain" required>
                    <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Domain --</option>
                    {{range .domains}}
                    {{if not .SSLEnabled}}
                    <option value="{{.Name}}">{{.Name}}</option>
                    {{end}}
                    {{end}}
                </select>
            </div>
            <div class="form-group">
                <label>Email (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô):</label>
                <input type="email" name="email" required placeholder="admin@example.com">
            </div>
            <button type="submit" class="btn btn-success">üöÄ ‡∏Ç‡∏≠ Certificate</button>
        </form>
        
        <div class="info-box">
            <h4>üìã ‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î:</h4>
            <ul>
                <li>Domain ‡∏ï‡πâ‡∏≠‡∏á point ‡∏°‡∏≤‡∏ó‡∏µ‡πà server ‡∏ô‡∏µ‡πâ‡πÅ‡∏•‡πâ‡∏ß</li>
                <li>Port 80 ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</li>
                <li>‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á certbot ‡∏ö‡∏ô server</li>
            </ul>
        </div>
    </div>
    
    <!-- SSL Status -->
    <div class="card">
        <h2>üìä ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ SSL ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h2>
        <table>
            <thead>
                <tr>
                    <th>Domain</th>
                    <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                    <th>‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏</th>
                    <th>‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th>
                    <th>Issuer</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {{range .domains}}
                <tr>
                    <td>
                        {{if .SSLEnabled}}
                        <a href="https://{{.Name}}" target="_blank">üîí {{.Name}}</a>
                        {{else}}
                        <a href="http://{{.Name}}" target="_blank">‚ö†Ô∏è {{.Name}}</a>
                        {{end}}
                    </td>
                    <td>
                        {{if .SSLEnabled}}
                        <span class="badge badge-success">‚úÖ Active</span>
                        {{else}}
                        <span class="badge badge-warning">‚ùå No SSL</span>
                        {{end}}
                    </td>
                    <td>
                        {{with index $.sslStatus .Name}}
                        {{if .expires}}{{.expires}}{{else}}-{{end}}
                        {{end}}
                    </td>
                    <td>
                        {{with index $.sslStatus .Name}}
                        {{if .days_left}}
                        <span class="{{if lt .days_left 30}}text-warning{{end}}{{if lt .days_left 7}}text-danger{{end}}">
                            {{.days_left}} ‡∏ß‡∏±‡∏ô
                        </span>
                        {{else}}-{{end}}
                        {{end}}
                    </td>
                    <td>
                        {{with index $.sslStatus .Name}}
                        {{if .issuer}}Let's Encrypt{{else}}-{{end}}
                        {{end}}
                    </td>
                    <td>
                        {{if .SSLEnabled}}
                        <form action="/ssl/renew/{{.Name}}" method="POST" style="display:inline;">
                            <button type="submit" class="btn btn-small btn-primary">üîÑ Renew</button>
                        </form>
                        <form action="/ssl/revoke/{{.Name}}" method="POST" style="display:inline;" onsubmit="return confirm('‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö SSL?');">
                            <button type="submit" class="btn btn-small btn-danger">üóëÔ∏è Revoke</button>
                        </form>
                        {{else}}
                        <span class="text-muted">-</span>
                        {{end}}
                    </td>
                </tr>
                {{end}}
            </tbody>
        </table>
    </div>
    
    <!-- Auto Renew Info -->
    <div class="card">
        <h2>üîÑ Auto Renew</h2>
        <p>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡∏ï‡πà‡∏≠‡∏≠‡∏≤‡∏¢‡∏∏ Certificate ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô</p>
        <p>Certificate ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 30 ‡∏ß‡∏±‡∏ô ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å renew ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</p>
        
        <div class="code-block">
            <code># ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö auto-renew ‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏ô‡πÄ‡∏≠‡∏á
sudo certbot renew --dry-run</code>
        </div>
    </div>
    
    <!-- Install Certbot -->
    <div class="card">
        <h2>üì¶ ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Certbot</h2>
        <p>‡∏´‡∏≤‡∏Å‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á certbot:</p>
        
        <div class="code-block">
            <code># Ubuntu/Debian
sudo apt update
sudo apt install certbot python3-certbot-nginx

# CentOS/RHEL
sudo dnf install certbot python3-certbot-nginx</code>
        </div>
    </div>
</div>

<style>
.card {
    background: #2a2a2a;
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 20px;
}

.card h2 {
    margin-bottom: 20px;
    color: #fff;
}

.form-group {
    margin-bottom: 15px;
}

.form-group label {
    display: block;
    margin-bottom: 5px;
    color: #ccc;
}

.form-group input, .form-group select {
    width: 100%;
    max-width: 400px;
    padding: 10px;
    background: #1a1a1a;
    border: 1px solid #3a3a3a;
    border-radius: 8px;
    color: #fff;
}

.btn {
    padding: 10px 20px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    transition: opacity 0.3s;
}

.btn:hover {
    opacity: 0.8;
}

.btn-success {
    background: #4CAF50;
    color: #fff;
}

.btn-primary {
    background: #2196F3;
    color: #fff;
}

.btn-danger {
    background: #f44336;
    color: #fff;
}

.btn-small {
    padding: 5px 10px;
    font-size: 12px;
}

.info-box {
    background: #1a1a1a;
    border-left: 4px solid #2196F3;
    padding: 15px;
    margin-top: 20px;
    border-radius: 0 8px 8px 0;
}

.info-box h4 {
    margin-bottom: 10px;
    color: #2196F3;
}

.info-box ul {
    margin: 0;
    padding-left: 20px;
}

.info-box li {
    margin-bottom: 5px;
    color: #ccc;
}

table {
    width: 100%;
    border-collapse: collapse;
}

th, td {
    padding: 12px;
    text-align: left;
    border-bottom: 1px solid #3a3a3a;
}

th {
    background: #1a1a1a;
    color: #fff;
}

td a {
    color: #4CAF50;
    text-decoration: none;
}

.badge {
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 12px;
}

.badge-success {
    background: #4CAF50;
    color: #fff;
}

.badge-warning {
    background: #FF9800;
    color: #fff;
}

.text-warning {
    color: #FF9800;
}

.text-danger {
    color: #f44336;
}

.text-muted {
    color: #666;
}

.code-block {
    background: #1a1a1a;
    padding: 15px;
    border-radius: 8px;
    margin-top: 10px;
    overflow-x: auto;
}

.code-block code {
    color: #4CAF50;
    white-space: pre;
}

.alert {
    padding: 15px;
    border-radius: 8px;
    margin-bottom: 20px;
}

.alert-error {
    background: rgba(244, 67, 54, 0.2);
    border: 1px solid #f44336;
    color: #f44336;
}

.alert-success {
    background: rgba(76, 175, 80, 0.2);
    border: 1px solid #4CAF50;
    color: #4CAF50;
}
</style>
{{end}}
